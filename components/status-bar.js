var StatusBarNamespace = {};StatusBarNamespace.CardIdentifier = "src";StatusBarNamespace.CardRequested = "";StatusBarNamespace.BarSelector = "div.status-bar.option-box";// ==Shared Functions== /function getStatusBar(id) {	var completeSelector = StatusBarNamespace.BarSelector + "[data-card-id=" + id + "]";	return jQuery(completeSelector);}function setLastRequestedCard(id) {	StatusBarNamespace.CardRequested = id;}function updateButtonGlyph(cardElement, btnSelector, glyphCode) {	cardElement.find(btnSelector).addClass("disabled");	cardElement.find(btnSelector + " span.glyphicon").replaceWith('<span class="glyphicon ' + glyphCode + '"></span>');}function reciprocityRequired(card_id) {	setLastRequestedCard(card_id);	var el = getStatusBar(card_id);	return el.data("requires-reciprocity");}//find appropriate name for method, and use for all post requestsfunction customPostRequest(url, data, success) {//alert(data);	jQuery.ajax({		url: url,		type: "POST",		data: data,		success: function (data) {			var response = JSON.parse(data);			success(response);		},		error: function (jqXHR, textStatus, errorThrown) {			console.log(textStatus, errorThrown);		}	});}// ==Shared Functions== \jQuery(document).on("click", "#mmConfirmReciprocity", function () {	checkReciprocityRequestingUserHasCard(addContact_sendRequest);});jQuery(document).on("click", "#btnConfirmReciprocity", function () {	checkReciprocityRequestingUserHasCard(sendRequestToServer);});function addContact(card_id) {//alert('adding contact');	if (reciprocityRequired(card_id)) {		showConfirmationModalWithSelector2({			title: 'Confirm',			message: 'This contact requires a mutual exchange, in short, your card will also be added to their contacts, do you want to continue?'		}, "mmConfirmReciprocity");	} else {		addContact_sendRequest();	}}function checkReciprocityRequestingUserHasCard(functionToCall) {	customPostRequest(					"includes/card-link/c_check_reciprocity_user_has_card.php",					{},					function (response) {						if (parseInt(response.result) > 0) {							functionToCall();						}						else {							showModalWithTitleAndMessage({title: 'Contact Not Added', message: 'This card requires a mutual exchange, but you do not currently have any cards. Please create a card first.'});						}					});}function addContact_sendRequest() {	customPostRequest(					"includes/card-link/c_add_contact.php",					{card_id: StatusBarNamespace.CardRequested},	function (response) {		if (response.success) {			UpdateViewOnAddContactSuccess(StatusBarNamespace.CardRequested);			swal({				title: "Contact Added",				text: "Contact added successfully!",				html: true,				type: "success",				showCancelButton: false,				confirmButtonColor: "#ff6603"			},			function(isConfirm){				if (isConfirm) {					location.reload();//					window.location.href = globalURL + "view-business-card.php?card_id=" + StatusBarNamespace.CardRequested;				} else {					window.location.href = globalURL + "home.php";				}			});//			showModalWithTitleAndMessage({title: 'Contact Added', message: 'Contact added successfully!', card_id: StatusBarNamespace.CardRequested});		} else {			swal({				title: "Contact Not Added",				text: "Contact could not be added!",				html: true,				type: "error",				showCancelButton: false,				confirmButtonColor: "#ff6603"			});//			showModalWithTitleAndMessage({title: 'Contact Not Added', message: 'Contact could not be added!'});		}	});}function sendLinkRequest(card_id) {	confirmReciprocity(card_id);}function confirmReciprocity(card_id) {	if (reciprocityRequired(card_id)) {		showConfirmationModalWithSelector({			title: 'Confirm',			message: 'This contact requires a mutual exchange, in short, your card will also be added to their contacts, do you want to continue?'		}, "modal_message_confirm_reciprocity");	} else {		sendRequestToServer();	}}function sendRequestToServer() {	//Init spinner	jQuery.loader({		className: "blue-with-image-2",		content: ''	});	customPostRequest(					"includes/card-link/c_link_request.php",					{card_id: StatusBarNamespace.CardRequested},	function (response) {		//stops spinner		console.log("closing");		setTimeout(function () {			jQuery.loader('close');		}, timeOut);		if (response.success) {			UpdateViewOnSendLinkRequestSuccess();			showModalWithTitleAndMessage({title: 'Request Successful', message: 'Request sent successfully!'});		} else {			showModalWithTitleAndMessage({title: 'Request Failed', message: 'Request could not be sent!'});		}	});}function UpdateViewOnSendLinkRequestSuccess() {	var cardElement = getStatusBar(StatusBarNamespace.CardRequested);	updateButtonGlyph(cardElement, ".btn-send-request", "glyphicon-time");}function UpdateViewOnAddContactSuccess(card_id) {	var cardElement = getStatusBar(card_id);	updateButtonGlyph(cardElement, ".btn-add-contact", "glyphicon-ok");}