// IMAGE UPLOADERjQuery(document).on("click", "#uploadImage", function () {	jQuery("#Image-B").hide();	jQuery("#Image").show();});// BACKGROUND IMAGE UPLOADERjQuery(document).on("click", "#uploadBimage", function () {	jQuery("#Image").hide();	jQuery("#Image-B").show();});// // APPEND IMAGE TO CANVAS// jQuery(document).on("submit", "#saveForm", function () {// 	var l = Ladda.create(document.querySelector('#submitForm'));// 	jQuery("#Image").hide();// 	var formData = new FormData(jQuery(this)[0]);// 	var formUrl = jQuery(this).attr("action");// 	jQuery.ajax({// 		url: formUrl,// 		type: "POST",// 		data: formData,// 		beforeSend: function () {//                 //l.start();//             },//             success: function (data) {//             	l.stop();//             	jQuery("#droppable").append(data);//             	jQuery(".new-image").draggable({ containment: "#droppable" });//             	jQuery(".new-image").resizable({ containment: "#droppable", minHeight: 10, maxHeight: 300 });//             },//             cache: false,//             contentType: false,//             processData: false//         });// 	return false;// });// // Background Image Form Submit// jQuery(document).on("submit", "#BForm", function () {// 	var l = Ladda.create(document.querySelector("#submitForm"));// 	jQuery("#Image").hide();// 	var formData = new FormData(jQuery(this)[0]);// 	var formUrl = jQuery(this).attr("action");// 	jQuery.ajax({// 		url: formUrl,// 		type: "POST",// 		data: formData,// 		beforeSend: function () {// 			l.start();// 		},// 		success: function (data) {// 			l.stop();// 			theWidth = jQuery("#droppable").width() + 2;// 			theHeight = jQuery("#droppable").height() + 2;//                 //newStyle = 'width:'+theWidth+'px; height:'+theHeight+'px; background-image: url('+data+') !important; background-color:#ffffff; background-position: center center; background-repeat:no-repeat; background-size:cover; -webkit-background-size:cover; -moz-background-size:cover; -o-background-size:cover;';//                 newStyle = "width:" + theWidth + "px; height:" + theHeight + "px; background: url(" + data + ") #ffffff center center no-repeat;";//                 jQuery("#droppable").attr("style", newStyle);//             },//             cache: false,//             contentType: false,//             processData: false//         });// 	return false;// });//File Uploading using Hidden iFrame --Supports://IE 6,7,8,9function uploadByIframe(fn, ifn, ldS, fin) {	var formName = fn,			iFrameName = ifn;	var l = Ladda.create(document.querySelector(ldS));	l.start();	jQuery(formName).target = iFrameName.substr(1, iFrameName.length);	jQuery(formName).submit();	jQuery(iFrameName).load(function () {		var result = jQuery(iFrameName).contents().find('p');		console.log('UPLOAD COMPLETE: formName' + fn + ' - iFrameName' + ifn + ' - result' + result);		fin(result);		l.stop();	});}//unnecessary functions just for debugging purposesfunction uploadLogoFront() {	var onSuccess = function () {		jQuery("#droppable").append(data);		jQuery(".new-image").draggable({containment: "#droppable"});		jQuery(".new-image").resizable({containment: "#droppable", minHeight: 10, maxHeight: 1000});	};	uploadByIframe('#saveForm', '#front_background_upload_iframe', '#submitForm', onSuccess)}function uploadLogoBack() {	var onSuccess = function () {		jQuery("#droppable").append(data);		jQuery(".new-image").draggable({containment: "#droppable"});		jQuery(".new-image").resizable({containment: "#droppable", minHeight: 10, maxHeight: 1000});	};	uploadByIframe('#saveForm', '#back_background_upload_iframe', '#saveForm', onSuccess)}function uploadBackgroundFront() {	var onSuccess = function () {		theWidth = jQuery("#droppable").width() + 2;		theHeight = jQuery("#droppable").height() + 2;		newStyle = "width:" + theWidth + "px; height:" + theHeight + "px; background: url(" + data + ") #ffffff center center no-repeat;";		jQuery("#droppable").attr("style", newStyle);	};	uploadByIframe('#BForm', '#front_logo_upload_iframe', '#submitForm', onSuccess)}function uploadBackgroundBack() {	var onSuccess = function () {		theWidth = jQuery("#droppable").width() + 2;		theHeight = jQuery("#droppable").height() + 2;		newStyle = "width:" + theWidth + "px; height:" + theHeight + "px; background: url(" + data + ") #ffffff center center no-repeat;";		jQuery("#droppable").attr("style", newStyle);	};	uploadByIframe('#BForm', '#back_logo_upload_iframe', '#saveForm', onSuccess)}// var eventHandler = function () {// 	if (iframeId.detachEvent) iframeId.detachEvent("onload", eventHandler);// 	else iframeId.removeEventListener("load", eventHandler, false);//             // Message from server...//             if (iframeId.contentDocument) {//             	content = iframeId.contentDocument.body.innerHTML;//             } else if (iframeId.contentWindow) {//             	content = iframeId.contentWindow.document.body.innerHTML;//             } else if (iframeId.document) {//             	content = iframeId.document.body.innerHTML;//             }//             document.getElementById(div_id).innerHTML = content;//             // Del the iframe...//             setTimeout('iframeId.parentNode.removeChild(iframeId)', 250);// }//         if (iframeId.addEventListener) iframeId.addEventListener("load", eventHandler, true);//         if (iframeId.attachEvent) iframeId.attachEvent("onload", eventHandler);function fileUploadLogo(form, action_url, div_id) {	//limit size of image upload	/*var canContinue = upLoadLimiter(400, '#inputFile');	 if (!canContinue) {	 return;	 };*/	// Create the iframe...	var iframe = document.createElement("iframe");	iframe.setAttribute("id", "upload_iframe");	iframe.setAttribute("name", "upload_iframe");	iframe.setAttribute("width", "0");	iframe.setAttribute("height", "0");	iframe.setAttribute("border", "0");	iframe.setAttribute("style", "width: 0; height: 0; border: none;");	// Add to document...	form.parentNode.appendChild(iframe);	window.frames['upload_iframe'].name = "upload_iframe";	iframeId = document.getElementById("upload_iframe");	// Add event...	var eventHandler = function () {		if (iframeId.detachEvent)			iframeId.detachEvent("onload", eventHandler);		else			iframeId.removeEventListener("load", eventHandler, false);		// Message from server...		if (iframeId.contentDocument) {			content = iframeId.contentDocument.body.innerHTML;		} else if (iframeId.contentWindow) {			content = iframeId.contentWindow.document.body.innerHTML;		} else if (iframeId.document) {			content = iframeId.document.body.innerHTML;		}		document.getElementById(div_id).innerHTML = "";		console.log(content);		var target;		var side;		if (isVisible(jQuery('#droppable'))) {			target = '#droppable';			side = 'front';		} else {			target = '#back-side-content-id';			side = 'back';		}		jQuery(target).append(content);//		jQuery(target).append('<img id="logo-'+side+'" class="img-responsive" src="' + content + '?' + d.getTime() + '" alt="" style="max-height: 280px; width: auto;" />');		jQuery(".new-image").draggable({containment: target});		jQuery(".new-image").resizable({			containment: target,			minHeight: 10,			maxHeight: 300,			minWidth: 10,			maxWidth: 530,			aspectRatio: false,			handles: "n, e, s, w, se, nw"		});		jQuery(".new-image").rotatable();		// Del the iframe...		setTimeout('iframeId.parentNode.removeChild(iframeId)', 250);	}	if (iframeId.addEventListener)		iframeId.addEventListener("load", eventHandler, true);	if (iframeId.attachEvent)		iframeId.attachEvent("onload", eventHandler);	// Set properties of form...	form.setAttribute("target", "upload_iframe");	form.setAttribute("action", action_url);	form.setAttribute("method", "post");	form.setAttribute("enctype", "multipart/form-data");	form.setAttribute("encoding", "multipart/form-data");	// Submit the form...	form.submit();	document.getElementById(div_id).innerHTML = "Uploading...";	jQuery("#LForm .upload-logo").addClass('disabled');}//jQuery('#btn-upload-bg').click(function(e){//	e.preventDefault();//	var side;//	var form = jQuery(this).closest('form');//	if(jQuery('.aboutCardposition').hasClass('active')){//		side = 'back';//		fileUploadBackgroundBack(jQuery(this).parent('form'), 'includes/create-business-card/background_back_upload.php', 'upload_background');//	}else{//		side = 'front';//		fileUploadBackground(form, 'includes/create-business-card/background_upload.php', 'upload_background');//	}////	alert(side);//});function fileUploadBackground(form, div_id, isBack) {	if (!jQuery('#btn-upload-bg').hasClass('disabled')){		//limit size of image upload		/*var canContinue = upLoadLimiter(400, '#inputFile');		 if (!canContinue) {		 return;		 };*/		// Create the iframe...		var action_url;		if (isBack) {			action_url = 'includes/create-business-card/background_back_upload.php';		} else {			action_url = 'includes/create-business-card/background_upload.php';		}		var iframe = document.createElement("iframe");		iframe.setAttribute("id", "upload_iframe");		iframe.setAttribute("name", "upload_iframe");		iframe.setAttribute("width", "0");		iframe.setAttribute("height", "0");		iframe.setAttribute("border", "0");		iframe.setAttribute("style", "width: 0; height: 0; border: none;");		// Add to document...		form.parentNode.appendChild(iframe);		window.frames['upload_iframe'].name = "upload_iframe";		iframeId = document.getElementById("upload_iframe");		// Add event...		var eventHandler = function () {			if (iframeId.detachEvent)				iframeId.detachEvent("onload", eventHandler);			else				iframeId.removeEventListener("load", eventHandler, false);			// Message from server...			if (iframeId.contentDocument) {				content = iframeId.contentDocument.body.innerHTML;			} else if (iframeId.contentWindow) {				content = iframeId.contentWindow.document.body.innerHTML;			} else if (iframeId.document) {				content = iframeId.document.body.innerHTML;			}			document.getElementById(div_id).innerHTML = "";			console.log(content);			var target;			var side;			if (isVisible(jQuery('#droppable'))) {				target = '#droppable';				side = 'front';			} else {				target = '#back-side-content-id';				side = 'back';			}			console.log('target: ' + target);			console.log('side: ' + side);			theWidth = jQuery(target).width() + 2;			theHeight = jQuery(target).height() + 2;//		newStyle = "width:" + theWidth + "px; height:" + theHeight + "px; background: url() #ffffff center center no-repeat;";//		newStyle = "width: auto; height: auto; background: url() #ffffff center center no-repeat;";			newStyle = "background: url() #ffffff center center no-repeat;";			jQuery(target).attr("style", newStyle);			var d = new Date();			var bgWidth, bgHeight;//		var containerHeight = jQuery(target).height();//		var containerWidth = jQuery(target).width();			var containerWidth = 539;			var containerHeight = 338;			var tmpImg = new Image();			tmpImg.src = content;			console.log(tmpImg);			jQuery(tmpImg).on('load', function () {				if (this.height > containerHeight) {					console.log(this.height);					console.log('.');					console.log(containerHeight);					bgHeight = containerHeight;					bgWidth = "auto";				} else {					console.log(this.height);					console.log('...');					console.log(containerHeight);					bgHeight = "auto";					bgWidth = "100%";				}				console.log('bgWidth = ' + bgWidth);				console.log('bgHeight = ' + bgHeight);				console.log('removing ' + "img#background-pic-" + side);				jQuery("img#background-pic-" + side).remove();				if (side === 'back') {					jQuery('#back-side-content-id p').remove();				}				jQuery('#resizing-container-' + side).remove();				console.log('appending to ' + target + ': <img id="background-pic-' + side + '" class="img-responsive" src="' + content + '?' + d.getTime() + '" alt="" width="' + bgWidth + '" height="' + bgHeight + '">');//			jQuery(target).prepend('<img id="background-pic-'+side+'" class="img-responsive" src="' + content + '?' + d.getTime() + '" alt="" width="' + bgWidth + '" height="' + bgHeight + '">');				jQuery(target).prepend("<div id='resizing-container-" + side + "' class='new-image-bg' style='position: relative; width:100%;  max-width:558px !important; height:auto; max-height:350px !important;position:absolute !important; top: 0; left: 0;'><span class='glyphicon glyphicon-remove del' style='cursor: pointer; position:absolute; top:0; right:0;z-index: 2;'></span><img id='background-pic-" + side + "' src='" + content + '?' + d.getTime() + "' alt='' style='width:100% !important; height:'100% !important;' ></div>");				jQuery(".new-image-bg").draggable({containment: '#droppable'});				jQuery(".new-image-bg").resizable({//			containment: '#droppable', 					minHeight: 10,					maxHeight: 350,					minWidth: 10,					maxWidth: 558,					aspectRatio: false,					handles: "n, e, s, w, se, nw"				});//			jQuery(".new-image-bg").rotatable();				jQuery('.fake-img').css({'display': 'none'});				// Del the iframe...//			setTimeout('iframeId.parentNode.removeChild(iframeId)', 250);			});		}		if (iframeId.addEventListener)			iframeId.addEventListener("load", eventHandler, true);		if (iframeId.attachEvent)			iframeId.attachEvent("onload", eventHandler);		// Set properties of form...		form.setAttribute("target", "upload_iframe");		form.setAttribute("action", action_url);		form.setAttribute("method", "post");		form.setAttribute("enctype", "multipart/form-data");		form.setAttribute("encoding", "multipart/form-data");		// Submit the form...		form.submit();		document.getElementById(div_id).innerHTML = "Uploading...";		jQuery("#BForm .upload-background").addClass('disabled');	}}